(this.webpackJsonpnwitter=this.webpackJsonpnwitter||[]).push([[0],{46:function(e,t,n){"use strict";n.r(t);var r=n(10),c=n.n(r),a=n(35),s=n.n(a),i=n(11),o=n(26),u=n(12),j=n(0),d=n.n(j),b=n(2),l=n(36),h=n(23),O=n(21),p=n(27),f=(Object(l.a)({apiKey:"AIzaSyDxNtsSowaCWleGUSgGzdiw9PgNitFAwW0",authDomain:"nwitter-a5816.firebaseapp.com",projectId:"nwitter-a5816",storageBucket:"nwitter-a5816.appspot.com",messagingSenderId:"626679426220",appId:"1:626679426220:web:40a90c7a55944b11b74309"}),{auth:Object(h.d)(),GoogleAuthProvider:h.b,GithubAuthProvider:h.a,createUserWithEmailAndPassword:h.c,signInWithEmailAndPassword:h.f,onAuthStateChanged:h.e,signInWithPopup:h.g,signOut:h.h,updateProfile:h.i}),x={db:Object(O.f)(),collection:O.b,addDoc:O.a,getDocs:O.e,onSnapshot:O.g,deleteDoc:O.c,doc:O.d,updateDoc:O.j,query:O.i,where:O.k,orderBy:O.h},m={storage:Object(p.c)(),ref:p.d,uploadString:p.e,getDownloadURL:p.b,deleteObject:p.a},v=n(7);var g=function(e){var t=e.userObj,n=e.refreshUser,c=Object(u.f)(),a=function(){var e=Object(b.a)(d.a.mark((function e(){var n,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=x.query(x.collection(x.db,"nweets"),x.where("creatorId","==",t.uid),x.orderBy("createdAt","desc")),e.next=3,x.getDocs(n);case 3:r=e.sent,c=r.docs.map((function(e){return e.data()})),console.log(c);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){a()}),[]);var s=function(){var e=Object(b.a)(d.a.mark((function e(t){var r,c,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=t.target,c=new FormData(r),a=Object.fromEntries(c),s=a.name,f.auth.currentUser){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,f.updateProfile(f.auth.currentUser,{displayName:s});case 8:n();case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{children:[Object(v.jsxs)("form",{onSubmit:s,children:[Object(v.jsx)("input",{type:"text",name:"name",placeholder:"Display name"}),Object(v.jsx)("button",{type:"submit",children:"Update Profile"})]}),Object(v.jsx)("button",{onClick:function(){f.signOut(f.auth),c("/",{replace:!0})},children:"Log Out"})]})},w=n(37);var y=function(e){Object(w.a)(e);var t=Object(r.useState)(!0),n=Object(i.a)(t,2),c=n[0],a=n[1],s=Object(r.useState)(""),o=Object(i.a)(s,2),u=o[0],j=o[1],l=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,a,s,i;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=new FormData(t.target),r=Object.fromEntries(n),a=r.email,s=r.password,e.prev=3,!c){e.next=10;break}return e.next=7,f.createUserWithEmailAndPassword(f.auth,a,s);case 7:i=e.sent,e.next=13;break;case 10:return e.next=12,f.createUserWithEmailAndPassword(f.auth,a,s);case 12:i=e.sent;case 13:console.log(i),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),j(e.t0.message);case 19:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("form",{onSubmit:l,children:[Object(v.jsx)("input",{name:"email",type:"email",placeholder:"Email",required:!0}),Object(v.jsx)("input",{name:"password",type:"password",placeholder:"Password",required:!0}),Object(v.jsx)("span",{children:u}),Object(v.jsx)("button",{type:"submit",children:c?"Create Acccount":"Log In"})]}),Object(v.jsx)("span",{onClick:function(){a((function(e){return!e}))},children:c?"Sign In":"Create Account"})]})};var D=function(){var e=function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=t.currentTarget.name,r={google:f.GoogleAuthProvider,github:f.GithubAuthProvider},c=new r[n],e.next=6,f.signInWithPopup(f.auth,c);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("div",{children:[Object(v.jsx)(y,{}),Object(v.jsxs)("div",{children:[Object(v.jsx)("button",{name:"google",onClick:e,children:"Continue with Goole"}),Object(v.jsx)("button",{name:"github",onClick:e,children:"Continue with Github"})]})]})},S=n(38);var k=function(e){var t=e.nweet,n=e.isOwner,c=Object(r.useState)(!1),a=Object(i.a)(c,2),s=a[0],o=a[1],u=function(){o((function(e){return!e}))},j=function(){var e=Object(b.a)(d.a.mark((function e(n){var r,c,a,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),r=n.target,c=new FormData(r),a=Object.fromEntries(c),s=a.contents,e.next=6,x.updateDoc(x.doc(x.db,"nweets",t.id),{contents:s});case 6:u();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsx)("div",{children:s?Object(v.jsxs)("form",{onSubmit:j,children:[Object(v.jsx)("input",{type:"text",name:"contents"}),Object(v.jsx)("button",{type:"submit",children:"Edit"})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("h4",{children:t.contents}),t.attachmentUrl&&Object(v.jsx)("img",{src:t.attachmentUrl,width:100,height:100,alt:"nweet-img"}),n&&Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("button",{onClick:u,children:"Edit"}),Object(v.jsx)("button",{onClick:function(){if(window.confirm("Are you sure?")){x.deleteDoc(x.doc(x.db,"nweets",t.id));var e=m.ref(m.storage,t.attachmentUrl);m.deleteObject(e)}},children:"Delete"})]})]})})},U=n(48);var A=function(e){var t=e.userObj,n=Object(r.useState)(),c=Object(i.a)(n,2),a=c[0],s=c[1],o=function(){var e=Object(b.a)(d.a.mark((function e(n){var r,c,s,i,o,u,j;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r=n.target,c=new FormData(r),console.log(Object.fromEntries(c)),s=Object.fromEntries(c),i=s.contents,u=m.ref(m.storage,"".concat(t.uid,"/").concat(Object(U.a)())),!a){e.next=14;break}return e.next=9,m.uploadString(u,a.data,"data_url");case 9:return j=e.sent,console.log(j),e.next=13,m.getDownloadURL(j.ref);case 13:o=e.sent;case 14:return e.next=16,x.addDoc(x.collection(x.db,"nweets"),{creatorId:t.uid,contents:i,createdAt:Date.now(),attachmentUrl:o});case 16:e.sent,r.reset();case 18:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(v.jsxs)("form",{onSubmit:o,children:[Object(v.jsx)("input",{type:"text",name:"contents",maxLength:120,placeholder:"What's on your mind?"}),Object(v.jsx)("input",{type:"file",accept:"image/*",onChange:function(e){var t=e.target.files;if(t){var n=t[0],r=new FileReader;r.onloadend=function(e){if(e.target){var t=e.target.result;s({type:n.type,data:t})}},r.readAsDataURL(n)}}}),Object(v.jsx)("button",{type:"submit",children:"Nweet"}),a&&Object(v.jsxs)("div",{children:[Object(v.jsx)("img",{src:a.data,width:100,height:100,alt:"preview"}),Object(v.jsx)("button",{type:"button",onClick:function(e){e.preventDefault(),s(void 0)},children:"Clear"})]})]})};var C=function(e){var t=e.userObj,n=Object(r.useState)([]),c=Object(i.a)(n,2),a=c[0],s=c[1];return Object(r.useEffect)((function(){x.onSnapshot(x.collection(x.db,"nweets"),(function(e){var t=e.docs.map((function(e){return Object(S.a)({id:e.id},e.data())}));s(t),console.log(e.docs)}))}),[]),Object(v.jsxs)("div",{children:[Object(v.jsx)(A,{userObj:t}),Object(v.jsx)("div",{children:a.map((function(e){return Object(v.jsx)(k,{nweet:e,isOwner:e.creatorId===t.uid},e.id)}))})]})};var E=function(e){var t=e.userObj;return Object(v.jsxs)("ul",{children:[Object(v.jsx)("li",{children:Object(v.jsx)(o.b,{to:"/",children:"Home"})}),Object(v.jsx)("li",{children:Object(v.jsxs)(o.b,{to:"/profile",children:[(null===t||void 0===t?void 0:t.displayName)||"\ub098","\uc758 Profile"]})})]})};var P=function(e){var t=e.userObj,n=e.refreshUser;return Object(v.jsxs)(o.a,{children:[Object(v.jsx)(E,{userObj:t}),Object(v.jsx)(u.c,{children:Object(v.jsx)(u.a,{path:"/",children:t?Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)(u.a,{index:!0,element:Object(v.jsx)(C,{userObj:t})}),Object(v.jsx)(u.a,{path:"/profile",element:Object(v.jsx)(g,{userObj:t,refreshUser:n})})]}):Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(u.a,{index:!0,element:Object(v.jsx)(D,{})})})})})]})};var I=function(){var e=Object(r.useState)(!1),t=Object(i.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(null),s=Object(i.a)(a,2),o=s[0],u=s[1];return Object(r.useEffect)((function(){return f.onAuthStateChanged(f.auth,(function(e){if(e){var t={uid:e.uid,displayName:e.displayName};u(t)}else u(null);c(!0)}))}),[]),n?Object(v.jsx)(v.Fragment,{children:Object(v.jsx)(P,{userObj:o,refreshUser:function(){if(f.auth.currentUser){var e={uid:f.auth.currentUser.uid,displayName:f.auth.currentUser.displayName};u(e)}}})}):Object(v.jsx)("span",{children:"Initalizing.."})};s.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(I,{})}),document.getElementById("root"))}},[[46,1,2]]]);
//# sourceMappingURL=main.41baad71.chunk.js.map